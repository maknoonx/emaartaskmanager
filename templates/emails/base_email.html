<!-- templates/emails/base_email.html -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ site_name }}{% endblock %}

<!-- templates/emails/task_completed.txt -->
مرحباً {{ user_name }}

تم إنجاز المهمة بنجاح! 🎉

تم إنجاز المهمة التي كلفت بها {{ completer_name }}

تفاصيل المهمة المكتملة:
- اسم المهمة: {{ task_name }}
- المشروع: {{ project_name }}
- تاريخ الإنجاز: {{ completion_date }}
- أنجزت بواسطة: {{ completer_name }}
{% if task.due_date %}
- تاريخ الاستحقاق الأصلي: {{ due_date }}
{% endif %}

لعرض المهمة: {{ task_url }}

نشكرك على متابعة المهام والإشراف على إنجازها بنجاح.

مع تحيات فريق {{ site_name }}

---
هذا إشعار تلقائي، يرجى عدم الرد على هذا البريد الإلكتروني.
للدعم التقني: {{ support_email|default:'support@eemar.org' }}

<!-- templates/emails/task_overdue.html -->
{% extends 'emails/base_email.html' %}

{% block title %}تنبيه: مهمة متأخرة - {{ site_name }}{% endblock %}

{% block content %}
<h2>مرحباً {{ user_name }}،</h2>

<div class="alert alert-danger">
    <strong>⚠️ تنبيه: لديك مهمة متأخرة</strong>
</div>

<p>نود تذكيرك بأن لديك مهمة تجاوزت تاريخ الاستحقاق المحدد لها.</p>

<div class="task-details">
    <h3>⏰ تفاصيل المهمة المتأخرة</h3>
    <ul class="task-meta">
        <li><strong>اسم المهمة:</strong> {{ task_name }}</li>
        <li><strong>المشروع:</strong> {{ project_name }}</li>
        <li><strong>تاريخ الاستحقاق:</strong> <span style="color: #dc3545;">{{ due_date }}</span></li>
        <li><strong>عدد الأيام المتأخرة:</strong> <span style="color: #dc3545;">{{ days_overdue }} يوم</span></li>
        <li><strong>الحالة:</strong> {{ task.get_status_display_arabic }}</li>
        {% if task.detail %}
        <li><strong>التفاصيل:</strong> {{ task.detail|truncatewords:20 }}</li>
        {% endif %}
    </ul>
</div>

<div class="text-center">
    <a href="{{ task_url }}" class="btn" style="background-color: #dc3545;">عرض المهمة والعمل عليها</a>
</div>

<p style="color: #dc3545;"><strong>يرجى إكمال هذه المهمة في أقرب وقت ممكن لتجنب تأخير المشروع.</strong></p>

<p>إذا كنت تواجه أي صعوبات في إنجاز المهمة، يرجى التواصل مع المشرف أو فريق الدعم.</p>

<p>مع تحيات،<br>فريق {{ site_name }}</p>
{% endblock %}

<!-- templates/emails/task_overdue.txt -->
مرحباً {{ user_name }}

⚠️ تنبيه: لديك مهمة متأخرة

نود تذكيرك بأن لديك مهمة تجاوزت تاريخ الاستحقاق المحدد لها.

تفاصيل المهمة المتأخرة:
- اسم المهمة: {{ task_name }}
- المشروع: {{ project_name }}
- تاريخ الاستحقاق: {{ due_date }}
- عدد الأيام المتأخرة: {{ days_overdue }} يوم
- الحالة: {{ task.get_status_display_arabic }}
{% if task.detail %}
- التفاصيل: {{ task.detail|truncatewords:20 }}
{% endif %}

لعرض المهمة: {{ task_url }}

يرجى إكمال هذه المهمة في أقرب وقت ممكن لتجنب تأخير المشروع.

إذا كنت تواجه أي صعوبات في إنجاز المهمة، يرجى التواصل مع المشرف أو فريق الدعم.

مع تحيات فريق {{ site_name }}

---
هذا إشعار تلقائي، يرجى عدم الرد على هذا البريد الإلكتروني.
للدعم التقني: {{ support_email|default:'support@eemar.org' }}

<!-- templates/emails/daily_digest.html -->
{% extends 'emails/base_email.html' %}

{% block title %}ملخص المهام اليومي - {{ site_name }}{% endblock %}

{% block content %}
<h2>مرحباً {{ user_name }}،</h2>

<p>إليك ملخص مهامك لليوم <strong>{{ today }}</strong>:</p>

{% if overdue_tasks %}
<div class="alert alert-danger">
    <h3 style="margin-top: 0;">⚠️ المهام المتأخرة ({{ overdue_tasks|length }})</h3>
    <ul style="margin-bottom: 0;">
    {% for task in overdue_tasks %}
        <li><strong>{{ task.name }}</strong> - {{ task.project.name|default:'بدون مشروع' }}
            {% if task.due_date %}
                (تأخرت {{ task.due_date|timesince }})
            {% endif %}
        </li>
    {% endfor %}
    </ul>
</div>
{% endif %}

{% if due_today_tasks %}
<div class="alert alert-warning">
    <h3 style="margin-top: 0;">📅 المهام المستحقة اليوم ({{ due_today_tasks|length }})</h3>
    <ul style="margin-bottom: 0;">
    {% for task in due_today_tasks %}
        <li><strong>{{ task.name }}</strong> - {{ task.project.name|default:'بدون مشروع' }}</li>
    {% endfor %}
    </ul>
</div>
{% endif %}

{% if assigned_tasks %}
<div class="task-details">
    <h3>📋 المهام المكلف بها ({{ assigned_tasks|length }})</h3>
    <ul style="list-style: none; padding: 0;">
    {% for task in assigned_tasks %}
        <li style="padding: 10px 0; border-bottom: 1px solid #eee;">
            <strong>{{ task.name }}</strong><br>
            <span style="color: #666;">المشروع: {{ task.project.name|default:'بدون مشروع' }}</span>
            {% if task.due_date %}
                <br><span style="color: #666;">الاستحقاق: {{ task.due_date }}</span>
            {% endif %}
        </li>
    {% endfor %}
    </ul>
</div>
{% endif %}

{% if created_tasks %}
<div class="task-details">
    <h3>✏️ المهام التي أنشأتها ({{ created_tasks|length }})</h3>
    <ul style="list-style: none; padding: 0;">
    {% for task in created_tasks %}
        <li style="padding: 10px 0; border-bottom: 1px solid #eee;">
            <strong>{{ task.name }}</strong><br>
            <span style="color: #666;">
                {% if task.assigned_to %}
                    مُعيّنة إلى: {{ task.assigned_to.name }}
                {% else %}
                    غير مُعيّنة
                {% endif %}
            </span>
            {% if task.due_date %}
                <br><span style="color: #666;">الاستحقاق: {{ task.due_date }}</span>
            {% endif %}
        </li>
    {% endfor %}
    </ul>
</div>
{% endif %}

<div class="text-center">
    <a href="{{ site_url }}/tasks/my-tasks/" class="btn">عرض جميع مهامي</a>
</div>

<div class="divider"></div>

<h3>📊 إحصائيات سريعة</h3>
<ul class="task-meta">
    <li><strong>المهام المتأخرة:</strong> <span style="color: #dc3545;">{{ overdue_tasks|length }}</span></li>
    <li><strong>المهام المستحقة اليوم:</strong> <span style="color: #fd7e14;">{{ due_today_tasks|length }}</span></li>
    <li><strong>إجمالي المهام النشطة:</strong> {{ assigned_tasks|length|add:created_tasks|length }}</li>
</ul>

<p>نتمنى لك يوماً منتجاً وموفقاً!</p>

<p>مع تحيات،<br>فريق {{ site_name }}</p>

<p class="text-muted" style="font-size: 12px;">
    يمكنك إلغاء الاشتراك في الملخص اليومي من إعدادات حسابك.
</p>
{% endblock %}

<!-- templates/emails/daily_digest.txt -->
مرحباً {{ user_name }}

ملخص مهامك لليوم {{ today }}:

{% if overdue_tasks %}
⚠️ المهام المتأخرة ({{ overdue_tasks|length }}):
{% for task in overdue_tasks %}
- {{ task.name }} - {{ task.project.name|default:'بدون مشروع' }}
{% endfor %}

{% endif %}
{% if due_today_tasks %}
📅 المهام المستحقة اليوم ({{ due_today_tasks|length }}):
{% for task in due_today_tasks %}
- {{ task.name }} - {{ task.project.name|default:'بدون مشروع' }}
{% endfor %}

{% endif %}
{% if assigned_tasks %}
📋 المهام المكلف بها ({{ assigned_tasks|length }}):
{% for task in assigned_tasks %}
- {{ task.name }} - {{ task.project.name|default:'بدون مشروع' }}
{% endfor %}

{% endif %}
📊 إحصائيات سريعة:
- المهام المتأخرة: {{ overdue_tasks|length }}
- المهام المستحقة اليوم: {{ due_today_tasks|length }}
- إجمالي المهام النشطة: {{ assigned_tasks|length|add:created_tasks|length }}

لعرض جميع مهامك: {{ site_url }}/tasks/my-tasks/

نتمنى لك يوماً منتجاً وموفقاً!

مع تحيات فريق {{ site_name }}

---
يمكنك إلغاء الاشتراك في الملخص اليومي من إعدادات حسابك.
هذا إشعار تلقائي، يرجى عدم الرد على هذا البريد الإلكتروني.
للدعم التقني: {{ support_email|default:'support@eemar.org' }}

<!-- templates/emails/welcome.html -->
{% extends 'emails/base_email.html' %}

{% block title %}مرحباً بك في {{ site_name }}{% endblock %}

{% block content %}
<h2>مرحباً {{ user_name }}،</h2>

<div class="alert alert-success">
    <strong>🎉 مرحباً بك في {{ site_name }}!</strong>
</div>

<p>نحن سعداء بانضمامك إلى فريق جمعية إعمار. تم إنشاء حسابك بنجاح ويمكنك الآن الوصول إلى نظام إدارة المهام والمشاريع.</p>

<div class="task-details">
    <h3>📋 معلومات حسابك</h3>
    <ul class="task-meta">
        <li><strong>الاسم:</strong> {{ user_name }}</li>
        <li><strong>البريد الإلكتروني:</strong> {{ user.email }}</li>
        <li><strong>المسمى الوظيفي:</strong> {{ user.job_title }}</li>
        <li><strong>القسم:</strong> {{ user.get_section_display_arabic }}</li>
        <li><strong>الرقم الوظيفي:</strong> {{ user.job_number }}</li>
    </ul>
</div>

<div class="text-center">
    <a href="{{ login_url }}" class="btn">تسجيل الدخول إلى النظام</a>
</div>

<h3>🚀 ما يمكنك فعله في النظام:</h3>
<ul>
    <li><strong>إدارة المهام:</strong> إنشاء وتتبع ومتابعة المهام المختلفة</li>
    <li><strong>المشاريع:</strong> العمل على المشاريع الجماعية والتعاونية</li>
    <li><strong>الأهداف الشهرية:</strong> تحديد ومتابعة أهدافك الشهرية</li>
    <li><strong>التقارير:</strong> مراجعة تقارير الأداء والإنجازات</li>
    <li><strong>التعاون:</strong> التواصل والتعاون مع زملائك في الفريق</li>
</ul>

<div class="alert alert-warning">
    <strong>💡 نصائح للبداية:</strong>
    <ul style="margin-bottom: 0;">
        <li>قم بتحديث معلومات ملفك الشخصي</li>
        <li>راجع إعدادات الإشعارات لتخصيصها حسب احتياجاتك</li>
        <li>ابدأ بمراجعة المهام المُعيّنة إليك</li>
        <li>تعرف على زملائك في الفريق والمشاريع الجارية</li>
    </ul>
</div>

<p>إذا كان لديك أي أسئلة أو تحتاج إلى مساعدة، لا تتردد في التواصل مع فريق الدعم التقني.</p>

<p>نتطلع إلى عمل منتج ومثمر معك!</p>

<p>مع تحيات،<br>فريق {{ site_name }}</p>
{% endblock %}

<!-- templates/emails/welcome.txt -->
مرحباً {{ user_name }}

🎉 مرحباً بك في {{ site_name }}!

نحن سعداء بانضمامك إلى فريق جمعية إعمار. تم إنشاء حسابك بنجاح ويمكنك الآن الوصول إلى نظام إدارة المهام والمشاريع.

معلومات حسابك:
- الاسم: {{ user_name }}
- البريد الإلكتروني: {{ user.email }}
- المسمى الوظيفي: {{ user.job_title }}
- القسم: {{ user.get_section_display_arabic }}
- الرقم الوظيفي: {{ user.job_number }}

لتسجيل الدخول: {{ login_url }}

ما يمكنك فعله في النظام:
• إدارة المهام: إنشاء وتتبع ومتابعة المهام المختلفة
• المشاريع: العمل على المشاريع الجماعية والتعاونية
• الأهداف الشهرية: تحديد ومتابعة أهدافك الشهرية
• التقارير: مراجعة تقارير الأداء والإنجازات
• التعاون: التواصل والتعاون مع زملائك في الفريق

نصائح للبداية:
• قم بتحديث معلومات ملفك الشخصي
• راجع إعدادات الإشعارات لتخصيصها حسب احتياجاتك
• ابدأ بمراجعة المهام المُعيّنة إليك
• تعرف على زملائك في الفريق والمشاريع الجارية

إذا كان لديك أي أسئلة أو تحتاج إلى مساعدة، لا تتردد في التواصل مع فريق الدعم التقني.

نتطلع إلى عمل منتج ومثمر معك!

مع تحيات فريق {{ site_name }}

---
هذا إشعار تلقائي، يرجى عدم الرد على هذا البريد الإلكتروني.
للدعم التقني: {{ support_email|default:'support@eemar.org' }} %}</title>
    <style>
        /* Email styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            direction: rtl;
            text-align: right;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            color: #333;
        }
        .email-container {
            max-width: 600px;
            margin: 0 auto;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .email-header {
            background: linear-gradient(135deg, #007AFF 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        .email-header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 600;
        }
        .email-body {
            padding: 30px 20px;
            line-height: 1.6;
        }
        .email-footer {
            background-color: #f8f9fa;
            padding: 20px;
            text-align: center;
            font-size: 14px;
            color: #666;
            border-top: 1px solid #eee;
        }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background-color: #007AFF;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            margin: 10px 0;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .task-details {
            background-color: #f8f9ff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-right: 4px solid #007AFF;
        }
        .task-details h3 {
            color: #007AFF;
            margin-top: 0;
        }
        .task-meta {
            list-style: none;
            padding: 0;
        }
        .task-meta li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .task-meta li:last-child {
            border-bottom: none;
        }
        .task-meta strong {
            color: #333;
            min-width: 120px;
            display: inline-block;
        }
        .alert {
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .alert-warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        .alert-success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .alert-danger {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .logo {
            max-width: 80px;
            height: auto;
            margin-bottom: 10px;
        }
        .divider {
            height: 1px;
            background-color: #eee;
            margin: 20px 0;
        }
        .text-center {
            text-align: center;
        }
        .text-muted {
            color: #666;
        }
        .mb-0 {
            margin-bottom: 0;
        }
        @media only screen and (max-width: 600px) {
            .email-container {
                width: 100% !important;
            }
            .email-header,
            .email-body,
            .email-footer {
                padding: 20px 15px !important;
            }
            .task-details {
                padding: 15px !important;
            }
        }
    </style>
</head>
<body>
    <div class="email-container">
        <!-- Header -->
        <div class="email-header">
            <img src="{{ logo_url|default:'#' }}" alt="{{ site_name }}" class="logo" style="display: none;">
            <h1>{{ site_name|default:'نظام إدارة جمعية إعمار' }}</h1>
        </div>

        <!-- Body -->
        <div class="email-body">
            {% block content %}
            <!-- Email content goes here -->
            {% endblock %}
        </div>

        <!-- Footer -->
        <div class="email-footer">
            <p class="mb-0">{{ company_name|default:'جمعية إعمار' }}</p>
            <p class="text-muted">{{ company_address|default:'المملكة العربية السعودية' }}</p>
            <div class="divider"></div>
            <p class="text-muted">
                هذا إشعار تلقائي، يرجى عدم الرد على هذا البريد الإلكتروني.
                <br>
                للدعم التقني: <a href="mailto:{{ support_email|default:'support@eemar.org' }}">{{ support_email|default:'support@eemar.org' }}</a>
            </p>
        </div>
    </div>
</body>
</html>

<!-- templates/emails/task_assigned.html -->
{% extends 'emails/base_email.html' %}

{% block title %}تم تكليفك بمهمة جديدة - {{ site_name }}{% endblock %}

{% block content %}
<h2>مرحباً {{ user_name }}،</h2>

<p>تم تكليفك بمهمة جديدة من قبل <strong>{{ assigner_name }}</strong>.</p>

<div class="task-details">
    <h3>📋 تفاصيل المهمة</h3>
    <ul class="task-meta">
        <li><strong>اسم المهمة:</strong> {{ task_name }}</li>
        <li><strong>المشروع:</strong> {{ project_name }}</li>
        <li><strong>تاريخ الاستحقاق:</strong> 
            {% if task.due_date %}
                {{ due_date }}
                {% if task.is_overdue %}
                    <span style="color: #dc3545;">(متأخرة)</span>
                {% elif task.days_remaining <= 3 %}
                    <span style="color: #fd7e14;">(تستحق قريباً)</span>
                {% endif %}
            {% else %}
                غير محدد
            {% endif %}
        </li>
        <li><strong>الحالة:</strong> {{ task.get_status_display_arabic }}</li>
        {% if task.detail %}
        <li><strong>التفاصيل:</strong> {{ task.detail|truncatewords:20 }}</li>
        {% endif %}
    </ul>
</div>

<div class="text-center">
    <a href="{{ task_url }}" class="btn">عرض المهمة</a>
</div>

<p>يرجى مراجعة المهمة والبدء في العمل عليها في أقرب وقت ممكن.</p>

<p>مع تحيات،<br>فريق {{ site_name }}</p>
{% endblock %}

<!-- templates/emails/task_assigned.txt -->
مرحباً {{ user_name }}

تم تكليفك بمهمة جديدة من قبل {{ assigner_name }}

تفاصيل المهمة:
- اسم المهمة: {{ task_name }}
- المشروع: {{ project_name }}
- تاريخ الاستحقاق: {{ due_date }}
- الحالة: {{ task.get_status_display_arabic }}
{% if task.detail %}
- التفاصيل: {{ task.detail|truncatewords:20 }}
{% endif %}

لعرض المهمة: {{ task_url }}

يرجى مراجعة المهمة والبدء في العمل عليها في أقرب وقت ممكن.

مع تحيات فريق {{ site_name }}

---
هذا إشعار تلقائي، يرجى عدم الرد على هذا البريد الإلكتروني.
للدعم التقني: {{ support_email|default:'support@eemar.org' }}

<!-- templates/emails/task_completed.html -->
{% extends 'emails/base_email.html' %}

{% block title %}تم إنجاز المهمة - {{ site_name }}{% endblock %}

{% block content %}
<h2>مرحباً {{ user_name }}،</h2>

<div class="alert alert-success">
    <strong>🎉 تم إنجاز المهمة بنجاح!</strong>
</div>

<p>تم إنجاز المهمة التي كلفت بها <strong>{{ completer_name }}</strong>.</p>

<div class="task-details">
    <h3>✅ تفاصيل المهمة المكتملة</h3>
    <ul class="task-meta">
        <li><strong>اسم المهمة:</strong> {{ task_name }}</li>
        <li><strong>المشروع:</strong> {{ project_name }}</li>
        <li><strong>تاريخ الإنجاز:</strong> {{ completion_date }}</li>
        <li><strong>أنجزت بواسطة:</strong> {{ completer_name }}</li>
        {% if task.due_date %}
        <li><strong>تاريخ الاستحقاق الأصلي:</strong> {{ due_date }}</li>
        {% endif %}
    </ul>
</div>

<div class="text-center">
    <a href="{{ task_url }}" class="btn">عرض المهمة</a>
</div>

<p>نشكرك على متابعة المهام والإشراف على إنجازها بنجاح.</p>

<p>مع تحيات،<br>فريق {{ site_name }}</p>
{% endblock %}